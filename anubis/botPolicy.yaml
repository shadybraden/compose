bots:
  # Include all default configuration
  - import: (data)/meta/default-config.yaml

  # Explicitly allow Docker clients
  - name: allow-docker-client
    action: ALLOW
    expression:
      all:
        - userAgent.contains("docker/")
        - userAgent.contains("git-commit/")

  - name: allow-crane-client
    action: ALLOW
    expression:
      all:
        - userAgent.contains("crane/")
        - userAgent.contains("go-containerregistry/")

  - name: allow-docker-distribution-api-client
    action: ALLOW
    expression:
      all:
        - '"Docker-Distribution-Api-Version" in headers'
        - '!(userAgent.contains("Mozilla"))'

  - name: allow-go-containerregistry-client
    action: ALLOW
    expression:
      all:
        - userAgent.contains("go-containerregistry/")

  - name: allow-buildah
    action: ALLOW
    expression:
      all:
        - userAgent.contains("Buildah/")

  - name: allow-podman
    action: ALLOW
    expression:
      all:
        - userAgent.contains("containers/")

  - name: allow-containerd
    action: ALLOW
    expression:
      all:
        - userAgent.contains("containerd/")